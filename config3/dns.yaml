plugins:
  ################ DNS #################

  - tag: forward_remote
    type: forward
    args:
      concurrent: 1
      upstreams:
        - addr: 127.0.0.1:7874 
  # ali doh dot h3
  - tag: ali
    type: forward
    args:
      concurrent: 3
      upstreams:
        - addr: "tls://dns.alidns.com"
          dial_addr: "2400:3200:baba::1"
          enable_pipeline: false
        - addr: "tls://dns.alidns.com"
          dial_addr: "223.5.5.5"
          enable_pipeline: false

  # dnspod doh dot
  - tag: dnspod
    type: forward
    args:
      concurrent: 3
      upstreams:
        - addr: "https://doh.pub/dns-query"
          dial_addr: "119.29.29.29"
          enable_http3: true
        - addr: "https://doh.pub/dns-query"
          dial_addr: "2402:4e00::"
          enable_http3: true

        - addr: "tls://dot.pub"
          dial_addr: "119.29.29.29"
          enable_pipeline: true
        - addr: "tls://dot.pub"
          dial_addr: "2402:4e00::"
          enable_pipeline: true

  # local dns
  - tag: local
    type: forward
    args:
      concurrent: 1
      upstreams:
        - addr: "udp://127.0.0.1:5553"

  # server 失败
  - tag: reject_2
    type: sequence
    args:
      - exec: reject 2

  # 拒绝响应
  - tag: reject_3
    type: sequence
    args:
      - exec: reject 3

  # 不支持的操作
  - tag: reject_5
    type: sequence
    args:
      - exec: reject 5
